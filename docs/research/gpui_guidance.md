# GPUI 使用ガイド（簡潔）

このドキュメントは `crates/gpui`（zed-fork 内）の主要 UI 要素の使い方を短くまとめたものです。具体的なコード例は `gpui_examples.md` を参照してください。

## 目的

開発者が短時間で基本的な UI 要素を理解し、プロジェクトに組み込めるようにする。

## 基本概念

- ウィンドウ: アプリの最上位コンテナ。イベントループに紐づけて表示/非表示を制御します。
- レイアウト: 水平／垂直スタック、グリッド、フレックスなどを用いて要素を配置します。
- パネル/ドッキング: 再配置可能なサイドバーやツールパネルを提供します。
- ウィジェット: ボタン、テキスト入力、ラベル、リスト、テーブル、プログレスバーなど。
- イベント: ユーザー操作（クリック、キーボード、選択）をハンドルするコールバック。

## よく使う UI 要素と使い方

- ウィンドウの作成: アプリ起動時にメインウィンドウを生成し、イベントループを回します。ウィンドウはタイトル／最小サイズ／初期レイアウトを指定できます。
- メニュー／ツールバー: アプリ固有のコマンドをメニューに登録し、ショートカットを紐付けます。ツールバーはよく使う操作をアイコンで提供します。
- ボタン: クリックイベントで処理を呼び出します。状態のあるボタン（トグル）もサポートします。
- テキスト入力: 単一行／複数行入力を提供します。入力イベントで候補表示や検証を行います。
- リスト／テーブル: データ一覧の表示に使用します。選択イベント、複数選択、ソート、フィルタを組み合わせます。
- ダイアログ: モーダル／ノンモーダルの確認ダイアログやファイル選択ダイアログを表示します。
- レスポンシブ更新: 長時間処理は非同期（別スレッド／タスク）で実行し、UI スレッドへ結果を送って再描画します。

## イベントと状態管理

- シンプルな状態: ウィジェット毎に状態（選択、入力値、表示／非表示）を持ち、変更時に再描画します。
- グローバル状態: アプリ全体の状態は中央のストア（あるいはシングルトン）で管理し、必要箇所で購読します。
- 非同期処理: `spawn` して結果をコールバックやチャネル経由で UI に反映します。

## 拡張ポイント（プラグイン連携）

- 実行ファイル横の `plugins/` ディレクトリにプラグインを置くことで、ランタイムでメタデータを読み込み、リスト表示や有効化操作を行えます（`neko-assistant` の `plugins` モジュール参照）。
- プラグイン一覧を表示する UI は、`List`（行ごとに有効/無効スイッチ、説明、バージョン）と詳細パネルを組み合わせるパターンが有効です。

## アクセシビリティとショートカット

- キーボード操作を優先して実装します（フォーカス移動、ショートカット）。
- 画面リーダー等を意識したラベル付けを行うと良いです（GPUI がサポートしていれば）。

## スタイリング / テーマ

- テーマ変数（色、フォント、間隔）を一元管理し、テーマ切替に対応させます。

## トラブルシュート（短いヒント）

- レンダリングが間に合わない場合は、頻繁な再描画を抑え、差分更新にする。
- 非同期結果を UI へ反映する際は、UI スレッドの安全な呼び出しパターン（チャネル等）を用いる。

詳細なコード例は `gpui_examples.md` を参照してください。

[gpui_examples.md を見る](gpui_examples.md)

***
更新履歴: 初版（簡潔ガイド）
